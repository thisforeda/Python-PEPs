## PEP 8 - Python 编码风格


### 简介
这份指南提供了包括标准库在内的Python发行版的编码约定。
你同样也可以参阅通过C编写Python代码的约定[PEP-0007]。
此文档与 PEP 257 （文档字符串编写约定） 改编自 Guido 关于Python编码风格的文章，以及来自Barry的编码指南的补充。
这份编码指南会随着语言本身以及其他原因而发生变化。
很多项目都会有自身的编码风格，所以，某些情况下，你需要遵从项目规定的风格而不是你现在看到的这些。

### 不要墨守成规。
Guido认为读代码比写代码要多得多。
这份指南主要是为了提高代码的可读性并且让其走大众路线而不是另辟小道。
就像 PEP 20中所说：可读性！
编码保持与此风格指南的一致性很重要，与项目整体风格一致更重要，一个功能或是一个模块中的一致性最重要。
但是，你要知道变通。
比如，有时指南中推荐的方法可能并不适用。
这时，你就要多看看别的例子或是别人的代码，然后自己决定选出最好的方案。

要注意：不要为了遵循PEP而丢掉了向后兼容！


以下情况你可以忽略编码规定：

  * 即便是对于一个已经熟读了PEP的人来说，遵循规定反而影响了代码可读性。
  * 由于某些原因，需要与周围代码保持一致。
  * 代码编写的时候，还没有相关编码约定的出世。
  * 当现代码需要与之前并不支持这项（语句，功能）的代码保持兼容时。


### 代码布局
#### 缩进
每一级缩进需要使用4个空格，现在，看代码。
> 建议这样做
```python
# Aligned with opening delimiter.
foo = long_function_name(var_one, var_two,
                         var_three, var_four)

# More indentation included to distinguish this from the rest.
def long_function_name(
        var_one, var_two, var_three,
        var_four):
    print(var_one)

# Hanging indents should add a level.
foo = long_function_name(
    var_one, var_two,
    var_three, var_four)
```
> 不建议这样做
```python
# Arguments on first line forbidden when not using vertical alignment.
foo = long_function_name(var_one, var_two,
    var_three, var_four)

# Further indentation required as indentation is not distinguishable.
def long_function_name(
    var_one, var_two, var_three,
    var_four):
    print(var_one)
```
> 4空格缩进对于连续行是可选的
```python
# Hanging indents *may* be indented to other than 4 spaces.
foo = long_function_name(
  var_one, var_two,
  var_three, var_four)
```
> 当if语句很长，一行容纳不下需要写成多行时，你可以使用以下方案。
```python
# No extra indentation.
if (this_is_one_thing and
    that_is_another_thing):
    do_something()

# Add a comment, which will provide some distinction in editors
# supporting syntax highlighting.
if (this_is_one_thing and
    that_is_another_thing):
    # Since both conditions are true, we can frobnicate.
    do_something()

# Add some extra indentation on the conditional continuation line.
if (this_is_one_thing
        and that_is_another_thing):
    do_something()
```
> 创建多行列表或是使用多行参数时，你也可以这样做
```python
my_list = [
    1, 2, 3,
    4, 5, 6,
    ]
result = some_function_that_takes_arguments(
    'a', 'b', 'c',
    'd', 'e', 'f',
    )
```
> 也可以
```python
my_list = [
    1, 2, 3,
    4, 5, 6,
]
result = some_function_that_takes_arguments(
    'a', 'b', 'c',
    'd', 'e', 'f',
)
```
#### 搞不清是用制表符还是空格？
不用说了，我们肯定推荐你使用空格。
也没说你就不能用制表符，当别的代码使用的是制表符时，你肯定不能破坏这个规则的吧？

注意： 不允许你在Python3中把制表符和空格一起混用！

如果你的Python2代码中混用了空格与制表符，请把它们统一转换为空格。

嗯，还有。
当你使用`-t`选项来使用Python2命令行时，当你混用空格与制表符时它会产生警告信息。
而当你使用`-tt`选项时，这些警告会被当成错误。我们非常推荐你这么做。

#### 不要让我看到你一行写的很长！
一行请不要超过79个字符。

对于没有什么结构限制的文本，例如注释或是文档字符串，你也应该限制它们的长度不能超过79个字符。
通过限制行的长度，你可以在一个编辑器中并排打开多个窗口，并且可以让你更容易的在代码审查工具中区分它们。

一些工具默认的编辑框将过长的代码换行，破坏了代码的可视性布局，让代码更加难以理解，即使那些编辑器为了便于区分，放了一个专门的字符在行尾。
所以，限制代码的长度可以一定程度上缓解这个问题。一些基于Web技术实现的编辑器还可能并不提供这种换行的机制。
（通过此源文件你也可以看到，我尽量每一句都换一行）

一些开发团队可能期望一行可以更长。为了可以达成共识，这个长度可以扩大到100个字符（建议是99个字符）。
当然，文档字符串或是注释仍应该不超过79个字符。

Python标准库仍要求79个字符的行长度与72个字符的注释长度。

对于一些真的，实在很长的行，你可以使用`\`来强制它们换行。
举一个例子，你写了一个很长的`with`语句。然后，你可以这样做：
```python
with open('/path/to/some/file/you/want/to/read') as file_1, \
     open('/path/to/some/file/being/written', 'w') as file_2:
    file_2.write(file_1.read())
```
但是你要确保换了行的代码缩进是正确的。

#### 我应该在运算符之前还是之后换行呢？
以前那些老司机的经验告诉你，你应该在运算符之后换行。

但是这可能会在两方面损坏代码的可读性：这些操作符会部落在每一行的不同列，还有操作符与操作数都分开了，前一个操作数在上一行，后一个却在下一行。
这样可能会看糊涂，不知道运算符在哪，就像这样：
```python
# No: operators sit far away from their operands
income = (gross_wages +
          taxable_interest +
          (dividends - qualified_dividends) -
          ira_deduction -
          student_loan_interest)
```
为了解决这个问题，大佬们提出了相反的方法。 Donald Knuth："Although formulas within a paragraph always break after binary operations and relations, displayed formulas always break before binary operations" [3].

是不是这个方法更加具有可读性？
```python
# Yes: easy to match operators with operands
income = (gross_wages
          + taxable_interest
          + (dividends - qualified_dividends)
          - ira_deduction
          - student_loan_interest)
```
在Python中，无论在前在后都是允许的，但是我们建议你使用后一种方法。

#### 你需要注意你的空行！
在每个函数（注意不是在类中的函数/方法，这里是文件级别的函数），还有每个类定义中间都要留有两个空行。

在类中的函数/方法之间应该留有一个空行。
一些情况下，你也可以使用更多的空行来分组一些函数（指示这几个函数是一组，那几个是一组）。
在一些未实现（`pass`, `NotImplemented`）代码中，你可以暂时忽略这些空行。

也可以在函数中使用空行来区分逻辑。

#### 关于源文件的编码。
在Python发行版中，你应该确保你的文件编码一直是UTF-8（在Python2中则是ASCII）。

使用ASCII（Python2）或是UTF-8（Python3）编码时无需在文件头声明编码类型。
